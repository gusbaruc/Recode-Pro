CREATE DATABASE LIVRARIA;

USE LIVRARIA;

CREATE TABLE AUTORES
(
    CODIGO INT,
    NOME VARCHAR(50),
    NACIONALIDADE VARCHAR(50),
    
    PRIMARY KEY(CODIGO)
);

CREATE TABLE FUNCIONARIOS
(
    CPF INT,
    NOME VARCHAR(50),
    ENDERECO VARCHAR(50),
    TELEFONE INT,
    SALARIO FLOAT,
    FUNCAO VARCHAR(50),
    
    PRIMARY KEY(CPF)
);

CREATE TABLE EDITORAS
(
    CODIGO INT,
    NOME VARCHAR(50),
    ENDERECO VARCHAR(50),
    CONTATO INT,
    
    PRIMARY KEY(CODIGO)
);

CREATE TABLE USUARIOS
(
    CPF INT,
    NOME VARCHAR(50),
    ENDERECO VARCHAR(50),
    TELEFONE INT,
    
    PRIMARY KEY(CPF)
);

CREATE TABLE LIVROS
(
    NUMERO INT,
    TITULO VARCHAR(50),
    GENERO CHAR(1),
    EDICAO INT,
    ANO_PUBLICACAO INT,
    CPF_FUNCIONARIO INT,
    CODIGO_EDITORA INT,
    CPF_USUARIO_RETIRAR INT,
    CPF_USUARIO_RESERVAR INT,
    
    PRIMARY KEY(NUMERO),
    FOREIGN KEY(CPF_FUNCIONARIO) REFERENCES FUNCIONARIOS(CPF),
    FOREIGN KEY(CODIGO_EDITORA) REFERENCES EDITORAS(CODIGO),
    FOREIGN KEY(CPF_USUARIO_RETIRAR) REFERENCES USUARIOS(CPF),
    FOREIGN KEY(CPF_USUARIO_RESERVAR) REFERENCES USUARIOS(CPF)
);

CREATE TABLE LIVROS_AUTORES
(   
    NUMERO_LIVRO INT,
    CODIGO_AUTOR INT,    

    FOREIGN KEY(NUMERO_LIVRO) REFERENCES LIVROS(NUMERO),
    FOREIGN KEY(CODIGO_AUTOR) REFERENCES AUTORES(CODIGO)
);

ALTER TABLE FUNCIONARIOS CHANGE TELEFONE TEL_RES INT;
ALTER TABLE FUNCIONARIOS ADD COLUMN CELULAR VARCHAR(20);
ALTER TABLE LIVROS DROP COLUMN GENERO;
ALTER TABLE LIVROS_AUTORES DROP TABLE LIVROS_AUTORES;